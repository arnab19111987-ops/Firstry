[pytest]
minversion = 8.0

# Only collect *your* tests
testpaths = 
    tests
    licensing/tests

# Don't descend into heavy/foreign trees
norecursedirs = .git .venv .venv-build .pytest_cache .mypy_cache .ruff_cache __pycache__ node_modules dist build .next coverage .firsttry benchmarks my-monorepo vscode-extension

# Sensible defaults; override in CI if needed
addopts = -q --maxfail=1 --disable-warnings -ra --import-mode=importlib --cov=src/firsttry --cov-report=term-missing --cov-fail-under=50

# Make repo root and src importable during collection
pythonpath = .
    src

# Coverage configuration
[coverage:run]
branch = True
source = src/firsttry

[coverage:report]
# Overall minimum coverage threshold
fail_under = 50
precision = 1
show_missing = True

# Per-file minimums for critical "brain" modules
# These must reach 80% coverage as part of Phase 1
per_file_thresholds =
    src/firsttry/runner/state.py: 80
    src/firsttry/runner/planner.py: 80
    src/firsttry/scanner.py: 80
    src/firsttry/smart_pytest.py: 80
